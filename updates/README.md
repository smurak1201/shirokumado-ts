# 仕様書の書き方ガイド

このドキュメントは、`updates/` ディレクトリ内の仕様書を新規作成する際のテンプレートと書き方を定義します。

**目的**: Claudeが仕様書を読み込んで実装作業を行えるようにする

---

## 目次

1. [Claudeでの作業について](#claudeでの作業について)
2. [仕様書のポイント](#claudeが作業しやすい仕様書のポイント)
3. [ファイル命名規則](#ファイル命名規則)
4. [基本構造](#基本構造)
5. [セクション詳細](#セクション詳細)
6. [テンプレート（コピー用）](#テンプレートコピー用)

---

## Claudeでの作業について

### 仕様書を新規作成する場合

Claudeに仕様書の作成を依頼する際は、以下のように指示してください：

```
updates/README.md を読んで、○○機能の仕様書を作成してください
```

> **Claudeへの指示**: 仕様書を作成する前に、必ず `CLAUDE.md` を読んでプロジェクトのコーディング規約を確認してください。

### 仕様書に沿って実装する場合

作成済みの仕様書に沿って実装を依頼する場合：

```
updates/YYYY-MM-DD-NN-タスク名.md を読んで、タスク1から順番に実装してください
```

### Claudeが参照するファイル

- **CLAUDE.md**: プロジェクト全体のコーディング規約
- **updates/README.md**: 仕様書の書き方ガイド（本ファイル）
- **仕様書**: `updates/` ディレクトリ内の作業指示書

### 仕様書作成のヒント

1. **ファイルパスはプロジェクトルートからの相対パスで記載**
   - 良い例: `app/components/Example.tsx`
   - 悪い例: `Example.tsx`

2. **期待する動作を明確に記載**
   - Claudeは指示が曖昧な場合、確認を求めます
   - 事前に詳細を記載しておくと、スムーズに作業が進みます

3. **既存コードの参照を活用**
   - 「`app/components/ProductGrid.tsx` を参考に実装」のように記載すると、Claudeはそのファイルを読んでスタイルを合わせます

4. **ビルド・テストの指示を含める**
   - 「実装後に `npm run build` を実行して、エラーがないことを確認」と記載すると、Claudeが自動で確認します

### 進捗管理

Claudeは仕様書内のチェックリストやステータスを更新できます。作業完了時に「進捗を更新して」と依頼してください。

---

## Claudeが作業しやすい仕様書のポイント

### 1. 曖昧さを排除する

- 「適切に」「必要に応じて」などの曖昧な表現を避ける
- 具体的な値、ファイルパス、クラス名を明記する

### 2. コードは「そのまま使える」形で書く

- 完全なコード例を提供する（省略しない）
- ファイルパスをコメントで明記する
- import文も含める

### 3. 変更箇所を明確にする

- 「変更前」と「変更後」を並べて示す
- 既存コードの何行目付近かを記載する
- 新規作成ファイルは明示的に「**新規作成**」と記載

### 4. タスクの依存関係を明示する

- タスクは実行順序通りに並べる
- 依存がある場合は備考欄に記載（例: 「タスク1完了後」）

### 5. 完了条件を具体的にする

- チェックリストは具体的なアクション単位
- 「動作確認」は何を確認するか明記

---

## ファイル命名規則

```
YYYY-MM-DD-NN-タスク名.md
```

- `YYYY-MM-DD`: 作成日（例: 2026-01-25）
- `NN`: 連番（01, 02, 03...）
- `タスク名`: ケバブケース（例: frontend-redesign, faq-page）

---

## 基本構造

1. **ヘッダー情報**（必須）
2. **進捗状況テーブル**（必須）
3. **改修の目的**（必須）
4. **CLAUDE.md準拠事項**（必須）
5. **タスク詳細**（必須）
6. **変更対象ファイル一覧**（必須）
7. **備考**（任意）
8. **実装後の更新ルール**（必須）

---

## セクション詳細

### 1. ヘッダー情報

```markdown
# タイトル

**日付**: YYYY-MM-DD
**ブランチ**: feature/ブランチ名
**対象**: 対象ページやコンポーネント名（ファイルパス）
**ステータス**: 未着手 | 進行中 | 完了
**完了日**: - | YYYY-MM-DD

---
```

### 2. 進捗状況テーブル

```markdown
## 進捗状況

| #   | タスク                 | 優先度 | ステータス | 備考 |
| --- | ---------------------- | :----: | :--------: | ---- |
| 1   | タスク名1              |   高   |    [ ]     |      |
| 2   | タスク名2              |   中   |    [ ]     |      |
| 3   | 動作確認・ビルドテスト |   -    |    [ ]     |      |

**凡例**: `[ ]` 未着手 / `[~]` 作業中 / `[o]` 完了

---
```

**優先度**: `高` / `中` / `低` / `-`（なし） / `後回し`

### 3. 改修の目的

```markdown
## 改修の目的

### 背景

なぜこの改修が必要なのかを説明する。

### 課題

- **課題1**: 説明
- **課題2**: 説明

### 設計方針

- **方針1**: 説明
- **方針2**: 説明

---
```

### 4. CLAUDE.md準拠事項

**Claudeがコーディング規約に従って実装するために必須。**

```markdown
### CLAUDE.md準拠事項

本改修では以下のルールに従うこと。

**設計原則**:

- **YAGNI**: 現時点で必要な機能のみ実装する
- **KISS**: 最もシンプルな解決策を選ぶ
- **DRY**: 3箇所目で共通化を検討

**コード品質**:

- 未使用のインポートは削除すること
- 関数の引数と返り値には型を付けること
- リントエラーを解消すること（`npm run lint`）

**Server/Client Components**:

- デフォルトで Server Components を使用
- `useState`, `useEffect`, `usePathname` 等を使用する場合は `"use client"` が必要

**セキュリティ**（認証・入力処理がある場合）:

- Server Actions でも認証を検証すること
- ユーザー入力はサニタイズすること
```

**ポイント**:

- タスク内容に応じて関連するルールのみ記載
- 特に注意が必要なルールは**太字**で強調
- プロジェクト固有の注意点があれば追記

### 5. タスク詳細（重要）

**Claudeが実装しやすい形式で書く。**

````markdown
## タスク詳細

### タスク1: タスク名

**対象ファイル**:

- `app/example/page.tsx`（既存・変更）
- `app/components/Example.tsx`（**新規作成**）

**問題点**:

現状の問題を1-2文で説明する。

**修正内容**:

何をどう変更するかを具体的に説明する。

**実装例**:

```tsx
// app/components/Example.tsx（新規作成）
"use client";

import { useState } from "react";

interface ExampleProps {
  title: string;
}

export default function Example({ title }: ExampleProps) {
  const [isOpen, setIsOpen] = useState(false);

  return (
    <div>
      <h1>{title}</h1>
      <button onClick={() => setIsOpen(!isOpen)}>
        {isOpen ? "閉じる" : "開く"}
      </button>
    </div>
  );
}
```

**page.tsx の変更（10行目付近）**:

```tsx
// 変更前
import { OldComponent } from "./OldComponent";

// 変更後
import Example from "../components/Example";
```

**チェックリスト**:

- [ ] `Example.tsx` を新規作成
- [ ] `page.tsx` で Example をインポート
- [ ] ビルドエラーがないこと

---
````

**ポイント**:

- コードは完全な形で記載（import文、型定義を含む）
- 既存ファイルの変更は「変更前」「変更後」を並べる
- 変更箇所は「○行目付近」と記載

### 6. 変更対象ファイル一覧

```markdown
## 変更対象ファイル一覧

| ファイル                     | 変更内容               | ステータス |
| ---------------------------- | ---------------------- | :--------: |
| `app/example/page.tsx`       | importの変更           |    [ ]     |
| `app/components/Example.tsx` | **新規作成**           |    [ ]     |
| `lib/config.ts`              | 定数追加（末尾に追記） |    [ ]     |

---
```

### 7. 備考（任意）

```markdown
## 備考

### 注意事項

- 既存の○○機能には影響を与えないこと
- `config.ts` の既存の定数は変更しないこと

### 参考

- 類似実装: `app/components/ProductGrid.tsx`

---
```

### 8. 実装後の更新ルール

```markdown
## 実装後の更新

### 進捗状況の更新

各タスク完了時に進捗状況テーブルを更新する:

- `[ ]` → `[~]` : 作業開始時
- `[~]` → `[o]` : 作業完了時
- 備考欄に補足情報があれば記載
- タスクの見出しに「[完了]」を追記する

### 完了時の更新

全タスク完了後:

1. ステータスを「未着手」→「完了」に変更
2. 完了日を追記
3. 実際に変更したファイル一覧を確認・更新
4. 検証結果をチェックリストに記入
5. 仕様書ファイルを `updates/completed/` ディレクトリに移動してよいか確認し、許可があれば移動
```

---

## テンプレート（コピー用）

````markdown
# [タイトル]

**日付**: YYYY-MM-DD
**ブランチ**: feature/xxx
**対象**: 対象ページ（`app/xxx/page.tsx`）
**ステータス**: 未着手
**完了日**: -

---

## 進捗状況

| #   | タスク                 | 優先度 | ステータス | 備考 |
| --- | ---------------------- | :----: | :--------: | ---- |
| 1   | タスク1                |   高   |    [ ]     |      |
| 2   | タスク2                |   中   |    [ ]     |      |
| 3   | 動作確認・ビルドテスト |   -    |    [ ]     |      |

**凡例**: `[ ]` 未着手 / `[~]` 作業中 / `[o]` 完了

---

## 改修の目的

### 背景

（なぜこの改修が必要なのか）

### 課題

- **課題1**: 説明
- **課題2**: 説明

### 設計方針

- **方針1**: 説明
- **方針2**: 説明

### CLAUDE.md準拠事項

本改修では以下のルールに従うこと。

**設計原則**:

- **YAGNI**: 現時点で必要な機能のみ実装する
- **KISS**: 最もシンプルな解決策を選ぶ

**コード品質**:

- 未使用のインポートは削除すること
- 関数の引数と返り値には型を付けること
- リントエラーを解消すること（`npm run lint`）

**Server/Client Components**:

- デフォルトで Server Components を使用
- `useState`, `useEffect` 等を使用する場合は `"use client"` が必要

（タスク内容に応じて関連するルールを追記・削除すること）

---

## タスク詳細

### タスク1: タスク名

**対象ファイル**:

- `ファイルパス`（既存・変更）
- `ファイルパス`（**新規作成**）

**問題点**:

（現状の問題を1-2文で）

**修正内容**:

（何をどう変更するか）

**実装例**:

```tsx
// ファイルパス
// 完全なコードを記載
```

**チェックリスト**:

- [ ] チェック項目1
- [ ] チェック項目2

---

### タスク2: 動作確認・ビルドテスト

**確認項目**:

1. **ローカル確認** (`npm run dev`)
   - [ ] 機能が正常に動作すること

2. **ビルド確認** (`npm run build`)
   - [ ] ビルドエラーがないこと
   - [ ] TypeScriptエラーがないこと

3. **品質チェックリスト**（CLAUDE.md準拠）
   - [ ] この機能は**今**必要か？（YAGNI）
   - [ ] もっとシンプルな方法はないか？（KISS）
   - [ ] 未使用のインポートは削除したか？
   - [ ] リントエラーは解消したか？（`npm run lint`）

---

## 変更対象ファイル一覧

| ファイル       | 変更内容     | ステータス |
| -------------- | ------------ | :--------: |
| `ファイルパス` | 変更内容     |    [ ]     |
| `ファイルパス` | **新規作成** |    [ ]     |

---

## 備考

（補足情報・注意事項・参考となる類似実装など）

---

## 実装後の更新

各タスクの進捗に応じて以下を更新する:

**状態遷移ルール**（共通）:

- `[ ]` 未着手 / `[~]` 作業中 / `[o]` 完了

1. **進捗状況テーブル**
   - 上記の状態遷移ルールに従って更新
   - 備考欄に補足情報があれば記載

2. **タスクの見出し**
   - 完了時に「[完了]」を追記する（例: `### タスク1: ... [完了]`）

3. **タスク内のチェックリスト**
   - `[ ]` 未着手 / `[~]` 作業中 / `[o]` 完了

### 完了時の更新

1. ステータスを「完了」に変更
2. 完了日を追記
3. チェックリストを更新
4. 仕様書ファイルを `updates/completed/` ディレクトリに移動してよいか確認し、許可があれば移動

```markdown
**ステータス**: 完了
**完了日**: YYYY-MM-DD
```
````

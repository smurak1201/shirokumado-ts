# 白熊堂 技術スタック

## 目次

- [概要](#概要)
- [フロントエンド](#フロントエンド)
  - [フレームワーク](#フレームワーク)
  - [UI ライブラリ](#ui-ライブラリ)
  - [スタイリング](#スタイリング)
  - [フォント](#フォント)
- [バックエンド](#バックエンド)
  - [ランタイム](#ランタイム)
  - [データベース](#データベース)
  - [ストレージ](#ストレージ)
- [言語・型システム](#言語型システム)
  - [言語](#言語)
  - [型定義](#型定義)
- [デプロイメント](#デプロイメント)
  - [ホスティング](#ホスティング)
  - [環境変数](#環境変数)
- [開発ツール](#開発ツール)
  - [リンター](#リンター)
  - [ビルドツール](#ビルドツール)
- [プロジェクト構造](#プロジェクト構造)
- [フロントエンド実装](#フロントエンド実装)
  - [ページ構成](#ページ構成)
  - [共通コンポーネント](#共通コンポーネント)
  - [画像最適化](#画像最適化)
- [今後の追加予定](#今後の追加予定)
- [開発コマンド](#開発コマンド)
- [参考リンク](#参考リンク)

## 概要

白熊堂（かき氷屋）のホームページプロジェクトの技術スタックドキュメントです。

このプロジェクトでは、モダンな Web 開発のベストプラクティスを採用し、保守性と拡張性を重視した技術選定を行っています。各技術の特徴と、このアプリケーションでの具体的な使われ方を詳しく説明します。

**技術選定の考え方**:

- **型安全性**: TypeScript と Prisma により、開発時から実行時まで型安全性を確保
- **開発者体験**: Next.js と Vercel の統合により、シームレスな開発・デプロイフローを実現
- **パフォーマンス**: Server Components、画像最適化、CDN 配信により、高速なユーザー体験を提供
- **スケーラビリティ**: サーバーレスアーキテクチャにより、トラフィックの増減に柔軟に対応
- **保守性**: コンポーネントベースのアーキテクチャと型定義の一元管理により、長期的な保守性を確保

## フロントエンド

### フレームワーク

- **Next.js** `16.1.1`

  Next.js は、React ベースの本番環境対応フレームワークです。サーバーサイドレンダリング（SSR）、静的サイト生成（SSG）、API Routes などの機能を統合的に提供し、モダンな Web アプリケーション開発を効率的に行えます。

  **主な特徴**:

  - **App Router**: ファイルベースのルーティングシステムで、直感的なページ構造を実現
  - **Server Components**: デフォルトでサーバーサイドでレンダリングされ、クライアントサイドの JavaScript を最小化
  - **自動的な最適化**: 画像最適化、コード分割、バンドル最適化が自動で行われる
  - **API Routes**: フロントエンドとバックエンドを同じプロジェクトで管理可能
  - **型安全性**: TypeScript との統合が優れており、型安全な開発が可能

  **このアプリでの使われ方**:

  - App Router を使用して、ファイルベースのルーティングを実装
  - Server Components を活用し、データベースから直接データを取得してレンダリング
  - API Routes で商品管理の CRUD 操作を実装
  - Next.js Image コンポーネントで画像の自動最適化と WebP 変換を実現
  - メタデータとフォント最適化により、SEO とパフォーマンスを向上

  **詳細な使用方法については、[Next.js ガイド](./guides/nextjs-guide.md) と [App Router ガイド](./guides/app-router-guide.md) を参照してください。**

### UI ライブラリ

- **React** `19.2.3`

  React は、ユーザーインターフェースを構築するための JavaScript ライブラリです。コンポーネントベースのアーキテクチャにより、再利用可能で保守しやすい UI を構築できます。

  **主な特徴**:

  - **コンポーネントベース**: UI を独立したコンポーネントに分割し、再利用性と保守性を向上
  - **仮想 DOM**: 効率的な DOM 更新により、パフォーマンスを最適化
  - **単方向データフロー**: データの流れが明確で、予測可能な動作を実現
  - **豊富なエコシステム**: 多数のサードパーティライブラリと統合可能
  - **Hooks**: 関数コンポーネントで状態管理や副作用を扱える仕組み

  **このアプリでの使われ方**:

  - Server Components と Client Components を適切に使い分け
  - Client Components でインタラクティブな機能（モーダル、商品選択など）を実装
  - カスタムフックで状態管理ロジックを分離
  - コンポーネントの再利用性を重視した設計

  **詳細な使用方法については、[React ガイド](./guides/react-guide.md) を参照してください。**

- **React DOM** `19.2.3`

  React DOM は、React コンポーネントを DOM にレンダリングするためのライブラリです。Next.js と統合され、サーバーサイドレンダリングとクライアントサイドハイドレーションを処理します。

### スタイリング

- **Tailwind CSS** `^4`

  Tailwind CSS は、ユーティリティファーストの CSS フレームワークです。従来の CSS フレームワークとは異なり、あらかじめ定義されたユーティリティクラスを組み合わせてスタイルを構築します。

  **主な特徴**:

  - **ユーティリティファースト**: 小さなユーティリティクラスを組み合わせてデザインを構築
  - **カスタマイズ性**: 設定ファイルでデザインシステムを自由にカスタマイズ可能
  - **レスポンシブデザイン**: プレフィックス（`sm:`, `md:`, `lg:`など）で簡単にレスポンシブ対応
  - **パフォーマンス**: 使用されていない CSS を自動的に削除（PurgeCSS）
  - **一貫性**: デザイントークン（色、スペーシング、タイポグラフィ）を統一

  **このアプリでの使われ方**:

  - レスポンシブデザインを実現（モバイル、タブレット、デスクトップに対応）
  - グリッドレイアウト（`grid-cols-3`, `grid-cols-4`）で商品一覧とフッターを実装
  - ユーティリティクラスで一貫したスペーシング、タイポグラフィ、カラーを適用
  - ホバーエフェクト（`hover:opacity-80`, `hover:shadow-lg`）でインタラクティブな UI を実現
  - カスタムフォント（Noto Sans JP）を設定ファイルで定義

- **PostCSS** (`@tailwindcss/postcss` `^4`)

  PostCSS は、CSS を変換するためのツールです。Tailwind CSS の処理や、自動ベンダープレフィックスの追加などを行います。Next.js と統合され、ビルド時に自動的に処理されます。

### フォント

- **Noto Sans JP** (Google Fonts)

  Noto Sans JP は、Google が開発した日本語を含む多言語対応のフォントファミリーです。日本語、中国語、韓国語など、幅広い文字セットをサポートしています。

  **主な特徴**:

  - **日本語対応**: ひらがな、カタカナ、漢字を含む日本語文字を完全サポート
  - **可読性**: スクリーン上での読みやすさを重視した設計
  - **統一感**: 複数の言語で統一されたデザイン
  - **Web フォント**: Google Fonts から提供され、CDN 経由で簡単に利用可能

  **このアプリでの使われ方**:

  - `app/layout.tsx` で Google Fonts から読み込み、デフォルトフォントとして設定
  - 日本語コンテンツ（商品名、説明、店舗情報など）の表示に使用
  - フォントの読み込みを最適化し、パフォーマンスへの影響を最小化

## バックエンド

### ランタイム

- **Node.js** `>=24.0.0` (LTS: Krypton)

  Node.js は、Chrome の V8 JavaScript エンジン上で動作する JavaScript ランタイムです。サーバーサイドで JavaScript を実行でき、Web アプリケーションのバックエンド開発に広く使用されています。

  **主な特徴**:

  - **非同期処理**: イベントループベースの非同期処理により、高いパフォーマンスを実現
  - **豊富なエコシステム**: npm パッケージマネージャーを通じて、多数のライブラリを利用可能
  - **クロスプラットフォーム**: Windows、macOS、Linux など、複数の OS で動作
  - **LTS バージョン**: 長期サポート版により、安定した運用が可能

  **このアプリでの使われ方**:

  - Vercel のランタイムとして使用され、Next.js アプリケーションを実行
  - Next.js API Routes でサーバーサイドのロジックを実装（商品の CRUD 操作など）
  - Prisma Client や Vercel Blob Storage SDK などの Node.js ライブラリを使用
  - `.nvmrc` ファイルで Node.js のバージョンを固定し、開発環境の一貫性を確保

### データベース

- **Vercel Neon** (PostgreSQL)

  Vercel Neon は、サーバーレスアーキテクチャの PostgreSQL データベースサービスです。従来のデータベースとは異なり、使用量に応じて自動的にスケールし、コスト効率が高いのが特徴です。

  **主な特徴**:

  - **サーバーレス**: インフラストラクチャの管理が不要で、自動スケーリングに対応
  - **PostgreSQL 互換**: 標準的な PostgreSQL の機能を完全サポート
  - **ブランチ機能**: データベースのブランチを作成し、開発・テスト環境を簡単に構築
  - **高速な接続**: エッジネットワーク経由で高速なデータベースアクセスを実現
  - **無料プラン**: 開発用途に十分な無料プランを提供

  **このアプリでの使われ方**:

  - 商品情報、カテゴリー情報、画像 URL などのデータを保存
  - 開発環境と本番環境で同じデータベースサービスを使用し、環境の一貫性を確保
  - Prisma を通じて型安全にデータベースにアクセス
  - 自動バックアップとリカバリー機能により、データの安全性を確保

- **Prisma** `^7.2.0`

  Prisma は、モダンなアプリケーション開発のための次世代 ORM（Object-Relational Mapping）です。型安全なデータベースアクセスと、直感的な API を提供します。

  **主な特徴**:

  - **型安全性**: TypeScript と統合され、コンパイル時に型エラーを検出
  - **マイグレーション**: スキーマ変更をバージョン管理し、安全にデータベースを更新
  - **Prisma Studio**: データベースの内容を視覚的に確認・編集できる GUI ツール
  - **クエリビルダー**: 直感的な API で複雑なクエリも簡単に記述
  - **リレーション**: 関連するデータを簡単に取得できるリレーション機能

  **このアプリでの使われ方**:

  - データベーススキーマを定義し、型安全なデータベースアクセスを実現
  - Server Components や API Routes から Prisma Client を使用してデータを取得・更新
  - マイグレーション機能でスキーマ変更を管理
  - N+1 問題を回避するためのクエリ最適化

  **詳細な使用方法については、[Prisma ガイド](./guides/prisma-guide.md) を参照してください。**

### ストレージ

- **Vercel Blob Storage**

  Vercel Blob Storage は、Vercel が提供するオブジェクトストレージサービスです。画像やファイルなどの静的アセットを保存・配信するために最適化されています。

  **主な特徴**:

  - **サーバーレス**: インフラストラクチャの管理が不要で、自動スケーリングに対応
  - **高速な配信**: グローバル CDN 経由で高速なファイル配信を実現
  - **シンプルな API**: RESTful API と SDK により、簡単にファイルをアップロード・管理
  - **コスト効率**: 使用量に応じた従量課金で、小規模なアプリケーションにも適している
  - **セキュリティ**: アクセス制御や署名付き URL により、セキュアなファイル管理が可能

  **このアプリでの使われ方**:

  - 商品画像をアップロード・保存し、CDN 経由で配信
  - `lib/blob.ts` にユーティリティ関数を実装し、画像アップロードと削除を簡潔に処理
  - クライアントサイドで画像を圧縮（`lib/image-compression.ts`）してからアップロードし、ストレージ容量を最適化
  - 開発環境と本番環境で同じストレージサービスを使用し、環境の一貫性を確保

- **@vercel/blob** `^2.0.0`

  Vercel Blob Storage の公式 SDK です。TypeScript で型安全にファイル操作を行えます。このアプリでは、画像アップロードと削除のロジックを `lib/blob.ts` に実装し、API Routes から呼び出しています。

## 言語・型システム

### 言語

- **TypeScript** `^5`

  TypeScript は、Microsoft が開発した JavaScript の型付きスーパーセットです。JavaScript に静的型付けを追加することで、大規模なアプリケーション開発を支援します。

  **主な特徴**:

  - **型安全性**: コンパイル時に型エラーを検出し、実行時エラーを事前に防止
  - **IDE サポート**: 優れた自動補完とリファクタリング機能により、開発効率を向上
  - **段階的導入**: JavaScript コードをそのまま TypeScript として実行可能
  - **最新の JavaScript 機能**: ES6+ の機能をサポートし、モダンな開発が可能
  - **エコシステム**: 多くのライブラリが TypeScript の型定義を提供

  **このアプリでの使われ方**:

  - フロントエンドとバックエンドの両方で型安全性を確保
  - 型定義を一元管理し、一貫性を保つ
  - Prisma の型生成機能と統合し、データベーススキーマから自動的に型を生成
  - API Routes のリクエスト・レスポンスの型を定義

  **詳細な使用方法については、[TypeScript ガイド](./guides/typescript-guide.md) を参照してください。**

### 型定義

- `@types/node` `^20`: Node.js の型定義
- `@types/react` `^19`: React の型定義
- `@types/react-dom` `^19`: React DOM の型定義

  これらのパッケージは、TypeScript で Node.js や React を使用する際に必要な型定義を提供します。これにより、IDE での自動補完や型チェックが正しく動作します。

## デプロイメント

### ホスティング

- **Vercel**

  Vercel は、Next.js の開発元が提供するモダンな Web アプリケーションのデプロイメントプラットフォームです。開発者体験を重視し、シンプルで高速なデプロイメントを実現します。

  **主な特徴**:

  - **自動デプロイ**: Git リポジトリと連携し、プッシュ時に自動的にデプロイ
  - **プレビュー環境**: プルリクエストごとに自動的にプレビュー環境を生成
  - **エッジネットワーク**: グローバル CDN により、世界中で高速な配信を実現
  - **サーバーレス関数**: API Routes を自動的にサーバーレス関数としてデプロイ
  - **分析機能**: パフォーマンス分析やアクセスログを提供
  - **無料プラン**: 個人プロジェクトや小規模なアプリケーションに十分な無料プランを提供

  **このアプリでの使われ方**:

  - GitHub リポジトリと連携し、`main` ブランチへのプッシュで自動デプロイ
  - プルリクエストごとにプレビュー環境を生成し、変更内容を確認してから本番環境にマージ
  - Next.js の最適化機能（画像最適化、コード分割など）を活用し、高速な配信を実現
  - 環境変数（データベース接続情報、Blob Storage 認証情報など）を Vercel のダッシュボードで管理
  - エッジネットワークにより、日本国内だけでなく世界中のユーザーに高速なアクセスを提供

### 環境変数

- Vercel の環境変数設定を使用
- 開発環境と本番環境で適切に管理

  環境変数は、データベース接続情報、API キー、Blob Storage の認証情報など、環境ごとに異なる設定値を管理するために使用します。Vercel のダッシュボードで環境変数を設定し、開発環境と本番環境で適切に分離して管理しています。

## 開発ツール

### リンター

- **ESLint** `^9`

  ESLint は、JavaScript と TypeScript のコード品質を保つための静的解析ツールです。コードのバグや潜在的な問題を検出し、コーディング規約を強制します。

  **主な特徴**:

  - **ルールベース**: 設定可能なルールにより、プロジェクトに合わせたコード品質を維持
  - **自動修正**: 多くの問題を自動的に修正可能
  - **プラグインシステム**: フレームワークやライブラリに特化したルールを追加可能
  - **エディタ統合**: VS Code などのエディタと統合し、リアルタイムで問題を表示

  **このアプリでの使われ方**:

  - Next.js 推奨の ESLint 設定（`eslint-config-next`）を使用
  - ビルド時に ESLint を実行し、コード品質の問題を検出
  - 開発中にエディタでリアルタイムに問題を表示し、早期に修正

- **eslint-config-next** `16.1.1`

  Next.js 公式の ESLint 設定です。Next.js のベストプラクティスに基づいたルールが含まれており、Next.js アプリケーションの開発に最適化されています。

### ビルドツール

- **Next.js 内蔵のビルドシステム**

  Next.js は、独自のビルドシステムを内蔵しており、TypeScript のコンパイル、コード分割、最適化などを自動的に処理します。追加のビルドツールの設定は不要です。

  **主な機能**:

  - **TypeScript コンパイル**: TypeScript を JavaScript に自動的にコンパイル
  - **コード分割**: ページやコンポーネントごとに自動的にコードを分割
  - **最適化**: バンドルサイズの最適化、ツリーシェイキングなど
  - **画像最適化**: 画像の自動最適化と WebP 変換

  **このアプリでの使われ方**:

  - `npm run build` コマンドでプロダクションビルドを実行
  - TypeScript の型チェックとコンパイルを自動的に実行
  - 最適化されたバンドルを生成し、パフォーマンスを向上

## プロジェクト構造

```
shirokumado-ts/
├── app/              # Next.js App Router
│   ├── api/         # API Routes
│   ├── components/  # フロントエンド共通コンポーネント
│   ├── dashboard/  # 商品管理ダッシュボード
│   ├── faq/        # FAQページ
│   ├── layout.tsx  # ルートレイアウト
│   ├── page.tsx    # ホームページ
│   └── globals.css # グローバルスタイル
├── lib/              # ユーティリティ・ライブラリ
│   ├── prisma.ts    # Prisma Clientインスタンス
│   ├── blob.ts      # Blobストレージユーティリティ
│   ├── env.ts       # 環境変数管理
│   ├── errors.ts    # 統一されたエラーハンドリング
│   ├── api-helpers.ts # API Routes用ヘルパー
│   ├── config.ts    # アプリケーション設定
│   ├── image-compression.ts # 画像圧縮
│   └── product-utils.ts # 商品関連ユーティリティ
├── prisma/           # Prisma設定
│   ├── schema.prisma # データベーススキーマ定義
│   └── migrations/  # マイグレーションファイル
├── public/          # 静的ファイル
│   ├── logo.webp    # ロゴ画像
│   ├── hero.webp    # ヒーロー画像
│   └── logo-instagram.svg # Instagramアイコン
├── doc/             # ドキュメント
│   ├── getting-started.md      # コードリーディングガイド
│   ├── architecture.md         # アーキテクチャと設計思想
│   ├── project-structure.md    # プロジェクト構造
│   ├── tech-stack.md           # 技術スタック
│   ├── development-guide.md    # 開発ガイドライン
│   ├── setup-prisma-blob.md    # Prisma & Blob セットアップガイド
│   ├── deployment.md           # デプロイメントガイド
│   └── guides/                 # ガイド系ドキュメント
│       ├── frontend-guide.md       # フロントエンドガイド
│       ├── dashboard-guide.md      # ダッシュボードガイド
│       ├── nextjs-guide.md         # Next.js ガイド
│       ├── app-router-guide.md     # App Router ガイド
│       ├── react-guide.md          # React ガイド
│       ├── typescript-guide.md     # TypeScript ガイド
│       └── prisma-guide.md         # Prisma ガイド
├── package.json     # 依存関係
├── tsconfig.json    # TypeScript設定
├── next.config.ts   # Next.js設定
└── eslint.config.mjs # ESLint設定
```

## フロントエンド実装

### ページ構成

- **ホームページ** (`app/page.tsx`): カテゴリーごとの商品表示
- **FAQ ページ** (`app/faq/page.tsx`): よくある質問ページ
- **ダッシュボード** (`app/dashboard/page.tsx`): 商品管理画面

### 共通コンポーネント

- **Header**: ヘッダー（ロゴ、Instagram リンク、ナビゲーション）
- **Footer**: フッター（店舗情報、地図、連絡先）
- **ProductGrid**: カテゴリーごとの商品グリッド表示
- **ProductTile**: 商品タイルコンポーネント
- **ProductModal**: 商品詳細モーダル

### 画像最適化

- **Next.js Image**: 自動的な画像最適化と WebP 変換
- **クライアントサイド圧縮**: `lib/image-compression.ts`で実装

## 今後の追加予定

### その他

- 認証システム（必要に応じて）
- テストフレームワーク（Jest、Vitest 等）

## 開発コマンド

```bash
# 開発サーバー起動
npm run dev

# プロダクションビルド
npm run build

# プロダクションサーバー起動
npm start

# リンター実行
npm run lint

# Prisma関連
npm run db:generate    # Prisma Clientを生成
npm run db:push        # スキーマをデータベースにプッシュ
npm run db:migrate     # マイグレーションを作成・適用
npm run db:studio      # Prisma Studioを起動
```

## 参考リンク

- [Next.js Documentation](https://nextjs.org/docs)
- [Vercel Documentation](https://vercel.com/docs)
- [Vercel Neon Documentation](https://neon.tech/docs)
- [Vercel Blob Documentation](https://vercel.com/docs/storage/vercel-blob)
- [Prisma Documentation](https://www.prisma.io/docs)
- [Tailwind CSS Documentation](https://tailwindcss.com/docs)
- [TypeScript Documentation](https://www.typescriptlang.org/docs/)
